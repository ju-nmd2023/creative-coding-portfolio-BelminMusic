<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.min.js"></script>

  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
    }

    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      z-index: 10;
    }

    #msg {
      color: #00e5ff;
      font-family: sans-serif;
      font-weight: bold;
      border: 2px solid #00e5ff;
      padding: 20px 30px;
      border-radius: 12px;
    }
  </style>
</head>

<body>

<div id="overlay">
  <div id="msg">CLICK TO START COSMIC WINDS ðŸŽµ</div>
</div>

<script>
  let particles = [];
  let started = false;
  let lead, pad, reverb;
  let t = 0;

  const MAX_PARTICLES = 600;
  const SCALE = ["C4", "Eb4", "G4", "Bb4", "C5"];

  document.getElementById("overlay").addEventListener("mousedown", () => {
    if (started) return;

    Tone.start().then(() => {

      reverb = new Tone.Reverb({
        decay: 4,
        wet: 0.35
      }).toDestination();

      lead = new Tone.Synth({
        oscillator: { type: "triangle" },
        envelope: {
          attack: 0.01,
          decay: 0.15,
          sustain: 0.2,
          release: 0.6
        }
      }).connect(reverb);

      pad = new Tone.PolySynth(Tone.Synth, {
        oscillator: { type: "sine" },
        envelope: {
          attack: 1.5,
          decay: 0.3,
          sustain: 0.4,
          release: 3
        }
      }).connect(reverb);

      started = true;
      document.getElementById("overlay").style.display = "none";
    });
  });

  function setup() {
    createCanvas(windowWidth, windowHeight);
    colorMode(HSB, 255);
    background(0);

    for (let i = 0; i < MAX_PARTICLES; i++) {
      particles.push(new Particle());
    }
  }


  function draw() {
    if (!started) return;

    background(0, 0, 0, 30);
    t += 0.002;

    for (let p of particles) {
      p.update();
      p.show();
    }

   
    if (frameCount % 18 === 0 && random() < 0.9) {
      lead.triggerAttackRelease(
        random(SCALE),
        "8n",
        undefined,
        0.12
      );
    }

  
    if (frameCount % 240 === 0) {
      pad.triggerAttackRelease(
        shuffle(SCALE).slice(0, 3),
        "2n"
      );
    }
  }


  class Particle {
    constructor() {
      this.pos = createVector(random(width), random(height));
      this.vel = p5.Vector.random2D();
      this.hue = random(255);
    }

    update() {
      let angle =
        sin(this.pos.y * 0.003 + t) +
        cos(this.pos.x * 0.003 + t);

      this.vel.rotate(angle * 0.02);
      this.vel.limit(2);
      this.pos.add(this.vel);

      if (this.pos.x < 0) this.pos.x = width;
      if (this.pos.x > width) this.pos.x = 0;
      if (this.pos.y < 0) this.pos.y = height;
      if (this.pos.y > height) this.pos.y = 0;
    }

    show() {
      stroke(this.hue, 160, 255, 70);
      strokeWeight(1.5);
      point(this.pos.x, this.pos.y);
    }
  }

  function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
    background(0);
  }
</script>

</body>
</html>
